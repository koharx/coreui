"use strict";var e=require("react/jsx-runtime"),t=require("react"),r=require("jwt-decode"),o=require("axios");const s=t.createContext(void 0);class n{constructor(e){Object.defineProperty(this,"instance",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"token",{enumerable:!0,configurable:!0,writable:!0,value:null}),this.instance=o.create({baseURL:e.baseURL,timeout:e.timeout||1e4,headers:{"Content-Type":"application/json",...e.headers}}),this.setupInterceptors()}setupInterceptors(){this.instance.interceptors.request.use(e=>(this.token&&(e.headers.Authorization=`Bearer ${this.token}`),e),e=>Promise.reject(e)),this.instance.interceptors.response.use(e=>e,async e=>{var t;return 401===(null===(t=e.response)||void 0===t?void 0:t.status)&&(this.token=null),Promise.reject(e)})}setToken(e){this.token=e}transformResponse(e){return{data:e.data,status:e.status,statusText:e.statusText,headers:e.headers}}async get(e,t){const r=await this.instance.get(e,t);return this.transformResponse(r)}async post(e,t,r){const o=await this.instance.post(e,t,r);return this.transformResponse(o)}async put(e,t,r){const o=await this.instance.put(e,t,r);return this.transformResponse(o)}async patch(e,t,r){const o=await this.instance.patch(e,t,r);return this.transformResponse(o)}async delete(e,t){const r=await this.instance.delete(e,t);return this.transformResponse(r)}}const a=t.createContext(void 0);class i{constructor(e={}){Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"logs",{enumerable:!0,configurable:!0,writable:!0,value:[]}),this.config={level:"info",enableConsole:!0,enableStorage:!0,maxEntries:1e3,...e}}shouldLog(e){const t=["debug","info","warn","error"],r=this.config.level||"info";return t.indexOf(e)>=t.indexOf(r)}addLog(e){if(this.logs.push(e),this.config.maxEntries&&this.logs.length>this.config.maxEntries&&(this.logs=this.logs.slice(-this.config.maxEntries)),this.config.enableStorage)try{const t=localStorage.getItem("app_logs"),r=t?JSON.parse(t):[];r.push({...e,timestamp:e.timestamp.toISOString()}),this.config.maxEntries&&r.length>this.config.maxEntries&&r.splice(0,r.length-this.config.maxEntries),localStorage.setItem("app_logs",JSON.stringify(r))}catch(e){console.warn("Failed to store log in localStorage:",e)}}log(e,t,r){if(!this.shouldLog(e))return;const o={level:e,message:t,timestamp:new Date,data:r};if(this.addLog(o),this.config.enableConsole){const o="debug"===e?"debug":e;r?console[o](t,r):console[o](t)}}debug(e,t){this.log("debug",e,t)}info(e,t){this.log("info",e,t)}warn(e,t){this.log("warn",e,t)}error(e,t,r){const o={level:"error",message:e,timestamp:new Date,error:t,data:r};this.addLog(o),this.config.enableConsole&&(t?console.error(e,t,r):console.error(e,r))}getLogs(e){return e?this.logs.filter(t=>t.level===e):[...this.logs]}clearLogs(){this.logs=[],this.config.enableStorage&&localStorage.removeItem("app_logs")}}const l=t.createContext(void 0),c=t.createContext(void 0),u=()=>{const e=t.useContext(c);if(void 0===e)throw new Error("useAlert must be used within an AlertProvider");return e},d=e=>{const t={padding:"12px 16px",borderRadius:"6px",marginBottom:"8px",border:"1px solid",display:"flex",justifyContent:"space-between",alignItems:"flex-start",minWidth:"300px",maxWidth:"400px",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)"};switch(e){case"success":return{...t,backgroundColor:"#d4edda",borderColor:"#c3e6cb",color:"#155724"};case"error":return{...t,backgroundColor:"#f8d7da",borderColor:"#f5c6cb",color:"#721c24"};case"warning":return{...t,backgroundColor:"#fff3cd",borderColor:"#ffeaa7",color:"#856404"};case"info":return{...t,backgroundColor:"#d1ecf1",borderColor:"#bee5eb",color:"#0c5460"};default:return t}};exports.AlertContainer=({position:t="top-right",className:r=""})=>{const{alerts:o,dismissAlert:s}=u(),n=(e=>{const t={position:"fixed",zIndex:9999,padding:"16px",pointerEvents:"none"};switch(e){case"top-right":default:return{...t,top:0,right:0};case"top-left":return{...t,top:0,left:0};case"bottom-right":return{...t,bottom:0,right:0};case"bottom-left":return{...t,bottom:0,left:0};case"top-center":return{...t,top:0,left:"50%",transform:"translateX(-50%)"};case"bottom-center":return{...t,bottom:0,left:"50%",transform:"translateX(-50%)"}}})(t);return e.jsxs("div",{style:n,className:r,children:[o.map(t=>e.jsxs("div",{style:{...d(t.type),pointerEvents:"auto",animation:"slideIn 0.3s ease-out"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontWeight:"bold",marginBottom:"4px"},children:t.title}),t.message&&e.jsx("div",{style:{fontSize:"14px",lineHeight:"1.4"},children:t.message})]}),t.dismissible&&e.jsx("button",{onClick:()=>s(t.id),style:{background:"none",border:"none",fontSize:"18px",cursor:"pointer",marginLeft:"12px",color:"inherit",opacity:.7},"aria-label":"Dismiss alert",children:"Ã—"})]},t.id)),e.jsx("style",{children:"\n          @keyframes slideIn {\n            from {\n              transform: translateX(100%);\n              opacity: 0;\n            }\n            to {\n              transform: translateX(0);\n              opacity: 1;\n            }\n          }\n        "})]})},exports.AlertProvider=({children:r,maxAlerts:o=5,defaultDuration:s=5e3})=>{const[n,a]=t.useState([]),i=t.useCallback(()=>Math.random().toString(36).substr(2,9),[]),l=t.useCallback(e=>{var t,r;const n=i(),l={...e,id:n,timestamp:new Date,duration:null!==(t=e.duration)&&void 0!==t?t:s,dismissible:null===(r=e.dismissible)||void 0===r||r};return a(e=>[...e,l].slice(-o)),n},[i,s,o]),u=t.useCallback((e,t,r)=>l({type:"success",title:e,message:t||"",...r}),[l]),d=t.useCallback((e,t,r)=>l({type:"error",title:e,message:t||"",...r}),[l]),g=t.useCallback((e,t,r)=>l({type:"warning",title:e,message:t||"",...r}),[l]),h=t.useCallback((e,t,r)=>l({type:"info",title:e,message:t||"",...r}),[l]),f=t.useCallback(e=>{a(t=>t.filter(t=>t.id!==e))},[]),p=t.useCallback(()=>{a([])},[]);return t.useEffect(()=>{const e=[];return n.forEach(t=>{if(t.duration&&t.duration>0){const r=setTimeout(()=>{f(t.id)},t.duration);e.push(r)}}),()=>{e.forEach(e=>clearTimeout(e))}},[n,f]),e.jsx(c.Provider,{value:{alerts:n,showAlert:l,showSuccess:u,showError:d,showWarning:g,showInfo:h,dismissAlert:f,clearAlerts:p},children:r})},exports.ApiProvider=({children:r,config:o})=>{const s=new n(o),i=t.useCallback(async(e,t)=>s.get(e,t),[s]),l=t.useCallback(async(e,t,r)=>s.post(e,t,r),[s]),c=t.useCallback(async(e,t,r)=>s.put(e,t,r),[s]),u=t.useCallback(async(e,t,r)=>s.patch(e,t,r),[s]),d=t.useCallback(async(e,t)=>s.delete(e,t),[s]);return e.jsx(a.Provider,{value:{get:i,post:l,put:c,patch:u,delete:d},children:r})},exports.AuthProvider=({children:o,apiClient:n})=>{const[a,i]=t.useState({user:null,token:null,isAuthenticated:!1,isLoading:!0,error:null}),l=t.useCallback(async()=>{try{const e=localStorage.getItem("auth_token");if(!e)return void i(e=>({...e,isLoading:!1}));const t=r.jwtDecode(e);i({user:{id:t.sub,email:t.email,name:t.name,roles:t.roles||[],permissions:t.permissions||[]},token:e,isAuthenticated:!0,isLoading:!1,error:null})}catch(e){localStorage.removeItem("auth_token"),i(e=>({...e,isLoading:!1,error:"Invalid token"}))}},[]);t.useEffect(()=>{l()},[l]);const c=t.useCallback(async e=>{try{i(e=>({...e,isLoading:!0,error:null}));const t=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw new Error("Login failed");const{token:o}=await t.json();localStorage.setItem("auth_token",o);const s=r.jwtDecode(o);i({user:{id:s.sub,email:s.email,name:s.name,roles:s.roles||[],permissions:s.permissions||[]},token:o,isAuthenticated:!0,isLoading:!1,error:null})}catch(e){throw i(t=>({...t,isLoading:!1,error:e instanceof Error?e.message:"Login failed"})),e}},[]),u=t.useCallback(()=>{localStorage.removeItem("auth_token"),i({user:null,token:null,isAuthenticated:!1,isLoading:!1,error:null})},[]),d=t.useCallback(async()=>{try{const e=await fetch("/api/auth/refresh",{method:"POST",headers:{"Content-Type":"application/json"}});if(!e.ok)throw new Error("Token refresh failed");const{token:t}=await e.json();localStorage.setItem("auth_token",t);const o=r.jwtDecode(t);i(e=>({...e,user:{id:o.sub,email:o.email,name:o.name,roles:o.roles||[],permissions:o.permissions||[]},token:t}))}catch(e){throw u(),e}},[u]),g=t.useCallback(e=>{var t,r;return(null===(r=null===(t=a.user)||void 0===t?void 0:t.roles)||void 0===r?void 0:r.includes(e))||!1},[a.user]),h=t.useCallback(e=>{var t,r;return(null===(r=null===(t=a.user)||void 0===t?void 0:t.permissions)||void 0===r?void 0:r.includes(e))||!1},[a.user]);return e.jsx(s.Provider,{value:{...a,login:c,logout:u,refreshToken:d,hasRole:g,hasPermission:h},children:o})},exports.LoggerProvider=({children:r,config:o})=>{const s=t.useRef(new i(o)),n=t.useCallback((e,t,r)=>{s.current.log(e,t,r)},[]),a=t.useCallback((e,t)=>{s.current.debug(e,t)},[]),c=t.useCallback((e,t)=>{s.current.info(e,t)},[]),u=t.useCallback((e,t)=>{s.current.warn(e,t)},[]),d=t.useCallback((e,t,r)=>{s.current.error(e,t,r)},[]),g=t.useCallback(e=>s.current.getLogs(e),[]),h=t.useCallback(()=>{s.current.clearLogs()},[]);return e.jsx(l.Provider,{value:{log:n,debug:a,info:c,warn:u,error:d,getLogs:g,clearLogs:h},children:r})},exports.createApiClient=e=>new n(e),exports.createLogger=e=>new i(e),exports.useAlert=u,exports.useApi=()=>{const e=t.useContext(a);if(void 0===e)throw new Error("useApi must be used within an ApiProvider");return e},exports.useAuth=()=>{const e=t.useContext(s);if(void 0===e)throw new Error("useAuth must be used within an AuthProvider");return e},exports.useDebounce=function(e,r){const[o,s]=t.useState(e);return t.useEffect(()=>{const t=setTimeout(()=>{s(e)},r);return()=>{clearTimeout(t)}},[e,r]),o},exports.useLocalStorage=function(e,r){const[o,s]=t.useState(()=>{if("undefined"==typeof window)return r;try{const t=window.localStorage.getItem(e);return t?JSON.parse(t):r}catch(t){return console.warn(`Error reading localStorage key "${e}":`,t),r}}),n=t.useCallback(t=>{try{const r=t instanceof Function?t(o):t;s(r),"undefined"!=typeof window&&window.localStorage.setItem(e,JSON.stringify(r))}catch(t){console.warn(`Error setting localStorage key "${e}":`,t)}},[e,o]);return t.useEffect(()=>{if("undefined"==typeof window)return;const t=t=>{if(t.key===e&&null!==t.newValue)try{s(JSON.parse(t.newValue))}catch(t){console.warn(`Error parsing localStorage key "${e}":`,t)}};return window.addEventListener("storage",t),()=>window.removeEventListener("storage",t)},[e]),[o,n]},exports.useLogger=()=>{const e=t.useContext(l);if(void 0===e)throw new Error("useLogger must be used within a LoggerProvider");return e},exports.useSessionStorage=function(e,r){const[o,s]=t.useState(()=>{if("undefined"==typeof window)return r;try{const t=window.sessionStorage.getItem(e);return t?JSON.parse(t):r}catch(t){return console.warn(`Error reading sessionStorage key "${e}":`,t),r}}),n=t.useCallback(t=>{try{const r=t instanceof Function?t(o):t;s(r),"undefined"!=typeof window&&window.sessionStorage.setItem(e,JSON.stringify(r))}catch(t){console.warn(`Error setting sessionStorage key "${e}":`,t)}},[e,o]);return t.useEffect(()=>{if("undefined"==typeof window)return;const t=t=>{if(t.key===e&&null!==t.newValue)try{s(JSON.parse(t.newValue))}catch(t){console.warn(`Error parsing sessionStorage key "${e}":`,t)}};return window.addEventListener("storage",t),()=>window.removeEventListener("storage",t)},[e]),[o,n]},exports.useThrottle=function(e,r){const[o,s]=t.useState(e),n=t.useRef(Date.now());return t.useEffect(()=>{const t=setTimeout(()=>{const t=Date.now();t-n.current>=r&&(s(e),n.current=t)},r-(Date.now()-n.current));return()=>{clearTimeout(t)}},[e,r]),o};
//# sourceMappingURL=index.js.map
